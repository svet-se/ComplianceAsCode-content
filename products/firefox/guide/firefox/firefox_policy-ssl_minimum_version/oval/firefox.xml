<def-group>
  <definition class="compliance" id="oval:ssg-firefox_policy-ssl_minimum_version:def:1" version="1">
    <metadata>
      <title>Firefox must be configured to allow only TLS 1.2 or above.</title>
      <affected family="unix">
        <product>Firefox</product>
      </affected>
      <description>Check setting of Disable Firefox Sync in Firefox policy</description>
      <reference ref_id="firefox_policy-ssl_minimum_version" source="ssg"/>
    </metadata>
    <criteria comment="Test conditions - Firefox policy item is set." operator="AND">
      <criterion comment="Check that Firefox administrative policy setting SSLVersionMin is configured as 'tls1.2' or 'tls1.3'." test_ref="oval:ssg-test_firefox_policy-ssl_minimum_version__SSLVersionMin:tst:1"/>
    </criteria>
  </definition>
  <ind:textfilecontent54_test check="all" comment="Check setting of .SSLVersionMin in Firefox policy file" id="oval:ssg-test_firefox_policy-ssl_minimum_version__SSLVersionMin:tst:1" version="1">
    <ind:object object_ref="oval:ssg-obj_firefox_policy-ssl_minimum_version__SSLVersionMin:obj:1"/>
  </ind:textfilecontent54_test>
  <ind:textfilecontent54_object id="oval:ssg-obj_firefox_policy-ssl_minimum_version__SSLVersionMin:obj:1" version="1">
    <ind:behaviors multiline="true" singleline="true"/>
    <ind:path datatype="string" var_check="at least one" var_ref="oval:ssg-var_firefox_policy-ssl_minimum_version_firefox_path:var:1"/>
    <ind:filename datatype="string">policies.json</ind:filename>
    <ind:pattern operation="pattern match">^(?i)\{\s*(?="policies")"policies"[\s]*:[\s]*\{[\s\S]*(?=[^"])SSLVersionMin"[\s]*:[\s]*"tls1\.[23]",?\s*</ind:pattern>
    <ind:instance datatype="int">1</ind:instance>
  </ind:textfilecontent54_object>
</def-group>
