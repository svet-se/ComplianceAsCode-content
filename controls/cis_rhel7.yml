policy: 'CIS benchmark for Red Hat Enterprise Linux 7'
title: 'CIS benchmark for Red Hat Enterprise Linux 7'
id: cis_rhel7
version: '3.1.1'
source: https://www.cisecurity.org/cis-benchmarks/#red_hat_linux
levels:
  - id: l1_server
  - id: l2_server
    inherits_from:
    - l1_server
  - id: l1_workstation
  - id: l2_workstation
    inherits_from:
    - l1_workstation

controls:
  - id: 1.1.1.1
    title: Ensure mounting of cramfs filesystems is disabled (Automated)
    levels:
    - l1_workstation
    - l1_server
    automated: yes
    rules:
    - kernel_module_cramfs_disabled

  - id: 1.1.1.2
    title: Ensure mounting of squashfs filesystems is disabled (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - kernel_module_squashfs_disabled

  - id: 1.1.1.3
    title: Ensure mounting of udf filesystems is disabled (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - kernel_module_udf_disabled

  - id: 1.1.1.2
    title: Ensure mounting of squashfs filesystems is disabled (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - partition_for_tmp

  - id: 1.1.3
    title: Ensure noexec option set on /tmp partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_tmp_noexec

  - id: 1.1.4
    title: Ensure nodev option set on /tmp partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_tmp_nodev

  - id: 1.1.5
    title: Ensure nosuid option set on /tmp partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_tmp_nosuid

  - id: 1.1.6
    title: Ensure /dev/shm is configured (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
#     rules:

  - id: 1.1.7
    title: Ensure noexec option set on /dev/shm partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_dev_shm_noexec

  - id: 1.1.8
    title: Ensure nodev option set on /dev/shm partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_dev_shm_nodev

  - id: 1.1.9
    title: Ensure nosuid option set on /dev/shm partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_dev_shm_nosuid

  - id: 1.1.10
    title: Ensure separate partition exists for /var (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_var

  - id: 1.1.11
    title: Ensure separate partition exists for /var/tmp (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_var_tmp

  - id: 1.1.12
    title: Ensure /var/tmp partition includes the noexec option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_var_tmp_noexec

  - id: 1.1.13
    title: Ensure /var/tmp partition includes the nodev option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_var_tmp_nodev

  - id: 1.1.14
    title: Ensure /var/tmp partition includes the nosuid option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_var_tmp_nosuid

  - id: 1.1.15
    title: Ensure separate partition exists for /var/log (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_var_log

  - id: 1.1.16
    title: Ensure separate partition exists for /var/log/audit (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_var_log_audit

  - id: 1.1.17
    title: Ensure separate partition exists for /home (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_home

  - id: 1.1.18
    title: Ensure /home partition includes the nodev option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_home_nodev

  - id: 1.1.19
    title: Ensure removable media partitions include noexec option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_noexec_removable_partitions

  - id: 1.1.20
    title: Ensure nodev option set on removable media partitions (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_nodev_removable_partitions

  - id: 1.1.21
    title: Ensure nosuid option set on removable media partitions (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_nosuid_removable_partitions

  - id: 1.1.22
    title: Ensure sticky bit is set on all world-writable directories (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - dir_perms_world_writable_sticky_bits

  - id: 1.1.23
    title: Disable Automounting (Automated)
    levels:
    - l1_server
    - l2_workstation
    automated: yes
    rules:
    - service_autofs_disabled

  - id: 1.1.24
    title: Disable USB Storage (Automated)
    levels:
    - l1_server
    - l2_workstation
    automated: yes
    rules:
    - kernel_module_usb-storage_disabled
