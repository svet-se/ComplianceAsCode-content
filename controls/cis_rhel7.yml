policy: 'CIS benchmark for Red Hat Enterprise Linux 7'
title: 'CIS benchmark for Red Hat Enterprise Linux 7'
id: cis_rhel7
version: '3.1.1'
source: https://www.cisecurity.org/cis-benchmarks/#red_hat_linux
levels:
  - id: l1_server
  - id: l2_server
    inherits_from:
    - l1_server
  - id: l1_workstation
  - id: l2_workstation
    inherits_from:
    - l1_workstation

controls:
  - id: 1.1.1.1
    title: Ensure mounting of cramfs filesystems is disabled (Automated)
    levels:
    - l1_workstation
    - l1_server
    automated: yes
    rules:
    - kernel_module_cramfs_disabled

  - id: 1.1.1.2
    title: Ensure mounting of squashfs filesystems is disabled (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - kernel_module_squashfs_disabled

  - id: 1.1.1.3
    title: Ensure mounting of udf filesystems is disabled (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - kernel_module_udf_disabled

  - id: 1.1.1.2
    title: Ensure mounting of squashfs filesystems is disabled (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - partition_for_tmp

  - id: 1.1.3
    title: Ensure noexec option set on /tmp partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_tmp_noexec

  - id: 1.1.4
    title: Ensure nodev option set on /tmp partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_tmp_nodev

  - id: 1.1.5
    title: Ensure nosuid option set on /tmp partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_tmp_nosuid

  - id: 1.1.6
    title: Ensure /dev/shm is configured (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
#     rules:

  - id: 1.1.7
    title: Ensure noexec option set on /dev/shm partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_dev_shm_noexec

  - id: 1.1.8
    title: Ensure nodev option set on /dev/shm partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_dev_shm_nodev

  - id: 1.1.9
    title: Ensure nosuid option set on /dev/shm partition (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_dev_shm_nosuid

  - id: 1.1.10
    title: Ensure separate partition exists for /var (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_var

  - id: 1.1.11
    title: Ensure separate partition exists for /var/tmp (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_var_tmp

  - id: 1.1.12
    title: Ensure /var/tmp partition includes the noexec option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_var_tmp_noexec

  - id: 1.1.13
    title: Ensure /var/tmp partition includes the nodev option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_var_tmp_nodev

  - id: 1.1.14
    title: Ensure /var/tmp partition includes the nosuid option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_var_tmp_nosuid

  - id: 1.1.15
    title: Ensure separate partition exists for /var/log (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_var_log

  - id: 1.1.16
    title: Ensure separate partition exists for /var/log/audit (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_var_log_audit

  - id: 1.1.17
    title: Ensure separate partition exists for /home (Automated)
    levels:
    - l2_server
    - l2_workstation
    automated: yes
    rules:
    - partition_for_home

  - id: 1.1.18
    title: Ensure /home partition includes the nodev option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_home_nodev

  - id: 1.1.19
    title: Ensure removable media partitions include noexec option (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_noexec_removable_partitions

  - id: 1.1.20
    title: Ensure nodev option set on removable media partitions (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_nodev_removable_partitions

  - id: 1.1.21
    title: Ensure nosuid option set on removable media partitions (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - mount_option_nosuid_removable_partitions

  - id: 1.1.22
    title: Ensure sticky bit is set on all world-writable directories (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - dir_perms_world_writable_sticky_bits

  - id: 1.1.23
    title: Disable Automounting (Automated)
    levels:
    - l1_server
    - l2_workstation
    automated: yes
    rules:
    - service_autofs_disabled

  - id: 1.1.24
    title: Disable USB Storage (Automated)
    levels:
    - l1_server
    - l2_workstation
    automated: yes
    rules:
    - kernel_module_usb-storage_disabled

  - id: 1.2.1
    title: Ensure GPG keys are configured (Manual)
    levels:
    - l1_server
    - l1_workstation
    automated: no

  - id: 1.2.2
    title: Ensure package manager repositories are configured (Manual)
    levels:
    - l1_server
    - l1_workstation
    automated: no

  - id: 1.2.3
    title: Ensure gpgcheck is globally activated (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - ensure_gpgcheck_globally_activated
    - ensure_gpgcheck_never_disabled

  - id: 1.2.4
    title: Ensure Red Hat Subscription Manager connection is configured (Manual)
    levels:
    - l1_server
    - l1_workstation
    automated: no

  - id: 1.2.4
    title: Ensure Red Hat Subscription Manager connection is configured (Manual)
    levels:
    - l1_server
    - l1_workstation
    automated: no

  - id: 1.2.5
    title: Disable the rhnsd Daemon (Manual)
    levels:
    - l1_server
    - l1_workstation
    automated: no

  - id: 1.3.1
    title: Ensure AIDE is installed (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - package_aide_installed
    - aide_build_database

  - id: 1.3.2
    title: Ensure filesystem integrity is regularly checked (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - aide_periodic_cron_checking

  - id: 1.4.1
    title: Ensure bootloader password is set (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - grub2_password
    - grub2_uefi_password

  - id: 1.4.2
    title: Ensure permissions on bootloader config are configured (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - file_groupowner_grub2_cfg
    - file_owner_grub2_cfg
    - file_permissions_grub2_cfg
    - file_groupowner_efi_grub2_cfg
    - file_owner_efi_grub2_cfg
    - file_permissions_efi_grub2_cfg

  - id: 1.4.3
    title: Ensure authentication required for single user mode (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - require_emergency_target_auth
    - require_singleuser_auth

  - id: 1.5.1
    title: Ensure core dumps are restricted (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - disable_users_coredumps
    - sysctl_fs_suid_dumpable
    - coredump_disable_backtraces
    - coredump_disable_storage

  - id: 1.5.2
    title: Ensure XD/NX support is enabled (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: partially
    notes: >-
      Automatic remediation of these rules is not available.
    rules:
    - bios_enable_execution_restrictions
    - install_PAE_kernel_on_x86-32

  - id: 1.5.3
    title: Ensure address space layout randomization (ASLR) is enabled (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: yes
    rules:
    - sysctl_kernel_randomize_va_space

  - id: 1.5.4
    title: Ensure prelink is not installed (Automated)
    levels:
    - l1_server
    - l1_workstation
    automated: partially
    notes: >-
      The rule to remove prelink package is missing.
    rules:
    - disable_prelink
