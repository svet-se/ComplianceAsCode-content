discover:
    how: fmf
    url: https://github.com/RHSecurityCompliance/contest.git
execute:
    how: tmt
adjust:
  - environment:
        CONTEST_VERBOSE: 0
report:
    how: html

#
# Hardening via ansible-playbook remediation
#

/hardening/host-os/ansible/anssi_bp28_high:
    discover+: {test: /hardening/host-os/ansible/anssi_bp28_high$}
    adjust+:
      - when: distro <= centos-7
        enabled: false

/hardening/host-os/ansible/cis:
    discover+: {test: /hardening/host-os/ansible/cis$}

/hardening/host-os/ansible/ospp:
    discover+: {test: /hardening/host-os/ansible/ospp$}

/hardening/host-os/ansible/pci-dss:
    discover+: {test: /hardening/host-os/ansible/pci-dss$}

/hardening/host-os/ansible/stig:
    discover+: {test: /hardening/host-os/ansible/stig$}

#
# Hardening via oscap xccdf eval --remediate
#

/hardening/host-os/oscap/anssi_bp28_high:
    discover+: {test: /hardening/host-os/oscap/anssi_bp28_high$}
    adjust+:
      - when: distro <= centos-7
        enabled: false

/hardening/host-os/oscap/cis:
    discover+: {test: /hardening/host-os/oscap/cis$}

/hardening/host-os/oscap/ospp:
    discover+: {test: /hardening/host-os/oscap/ospp$}

/hardening/host-os/oscap/pci-dss:
    discover+: {test: /hardening/host-os/oscap/pci-dss$}

/hardening/host-os/oscap/stig:
    discover+: {test: /hardening/host-os/oscap/stig$}

#
# Misc smoke/sanity tests
#

/static-checks:
    discover+:
        test: /static-checks
        # exclude here due to the test failing frequently for short periods
        # of time, as many websites have temporary availability issues
        exclude: /static-checks/html-links
