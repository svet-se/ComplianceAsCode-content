<Group id="http">
<title>Web Server</title>
<description>The web server is responsible for providing access to
content via the HTTP protocol. Web servers represent a significant
security risk because:
<br /><br />
<ul>
<li>The HTTP port is commonly probed by malicious sources</li>
<li>Web server software is very complex, and includes a long
history of vulnerabilities</li>
<li>The HTTP protocol is unencrypted and vulnerable to passive
monitoring</li>
</ul>
<br /><br />
The system's default web server software is Apache 2 and is
provided in the RPM package <tt>httpd</tt>.</description>

<Group id="disabling_httpd">
<title>Disable Apache if Possible</title>
<description>If Apache was installed and activated, but the system
does not need to act as a web server, then it should be disabled
and removed from the system.
</description>

<Rule id="service_httpd_disabled" prodtype="rhel7">
<title>Disable httpd Service</title>
<description>
<systemd-service-macro enable="false" service="httpd" />
</description>
<ocil>
<systemd-check-macro enable="false" service="httpd" />
</ocil>
<rationale>
Running web server software provides a network-based avenue
of attack, and should be disabled if not needed.
</rationale>
<ident prodtype="rhel7" cce="80300-7" />
<oval id="service_httpd_disabled" />
<ref nist="CM-7" cis="2.2.10" />
</Rule>

<Rule id="package_httpd_removed" prodtype="rhel7">
<title>Uninstall httpd Package</title>
<description>
<yum-macro install="false" package="httpd" />
</description>
<ocil>
<package-check-macro package="httpd" />
</ocil>
<rationale>
If there is no need to make the web server software available,
removing it provides a safeguard against its activation.
</rationale>
<ident prodtype="rhel7" cce="80301-5" />
<oval id="package_httpd_removed" />
<ref nist="CM-7" />
</Rule>

</Group> <!--<Group id="disabling_httpd"> -->

<Group id="installing_httpd">
<title>Install Apache if Necessary</title>
<description>If <tt>httpd</tt> was not installed and activated, but the system
needs to act as a web server, then it should be installed on the system. Follow these
guidelines to install it defensively. The <tt>httpd</tt> package can be installed with
the following command:
<pre>$ sudo yum install httpd</pre>
This method of installation is recommended over installing the "Web Server"
package group during the system installation process. The Web Server package
group includes many packages which are likely extraneous, while the
command-line method installs only the required <tt>httpd</tt> package itself.
</description>

<Group id="httpd_minimal_modules_installed">
<title>Confirm Minimal Built-in Modules Installed</title>
<description>The default <tt>httpd</tt> installation minimizes the number of
modules that are compiled directly into the binary (<tt>core prefork http_core
mod_so</tt>). This minimizes risk by limiting the capabilities allowed by the
web server.

Query the set of compiled-in modules using the following command:
<pre>$ httpd -l</pre>
If the number of compiled-in modules is significantly larger than the
aforementioned set, this guide recommends re-installing <tt>httpd</tt> with a
reduced configuration. Minimizing the number of modules that are compiled into
the <tt>httpd</tt> binary, reduces risk by limiting the capabilities allowed by
the webserver.
</description>

</Group> <!-- <Group id="httpd_minimal_modules_installed"> -->

</Group> <!-- <Group id="installing_httpd"> -->

<Group id="securing_httpd">
<title>Secure Apache Configuration</title>
<description>The <tt>httpd</tt> configuration file is
<tt>/etc/httpd/conf/httpd.conf</tt>. Apply the recommendations in the remainder
of this section to this file.</description>

<Value id="var_httpd_loglevel" type="string" >
<title>HTTPD Log Level</title>
<description>The setting for LogLevel in /etc/httpd/conf/httpd.conf</description>
<value selector="">warn</value>
<value selector="alert">alert</value>
<value selector="crit">crit</value>
<value selector="emerg">emerg</value>
<value selector="error">error</value>
<value selector="warn">warn</value>
</Value>

<Value id="var_max_keepalive_requests" type="number" >
<title>Maximum KeepAlive Requests for HTTPD</title>
<description>The setting for MaxKeepAliveRequests in httpd.conf</description>
<value selector="">100</value>
<value selector="100">100</value>
<value selector="500">500</value>
<value selector="1000">1000</value>
<value selector="10000">10000</value>
<value selector="100000">100000</value>
</Value>

<Rule id="httpd_enable_error_logging" severity="medium" prodtype="rhel7">
<title>Enable HTTPD Error Logging</title>
<description>
<tt>ErrorLog</tt> should be enabled and set to the following in
<tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>ErrorLog "logs/error_log"</pre>
</description>
<ocil clause="it is not">
To verify if <tt>ErrorLog</tt> is configured correctly in
<tt>/etc/httpd/conf/httpd.conf</tt>, run the following command:
<pre>$ grep -i errorlog /etc/httpd/conf/httpd.conf</pre>
The output should return the following:
<pre>ErrorLog "logs/error_log"</pre>
</ocil>
<rationale>
The server error logs are invaluable because they can also be used to identify
potential problems and enable proactive remediation. Log data can reveal
anomalous behavior such as "not found" or "unauthorized" errors that may
be an evidence of attack attempts. Failure to enable error logging can
significantly reduce the ability of Web Administrators to detect or remediate
problems.
</rationale>
<ident cce=""/>
<oval id="httpd_enable_error_logging"/>
<ref disa="" nist="" srg="" stigid="WA00605"/>
</Rule>

<Rule id="httpd_configure_log_format" severity="medium" prodtype="rhel7">
<title>Configure Error Log Format</title>
<description>
<tt>LogFormat</tt> should be enabled and set to the following in
<tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>LogFormat "a %A %h %H %l %m %s %t %u %U \"%{Referer}i\" \"%{User-Agent}i\"" combined</pre>
</description>
<ocil clause="it is not">
To verify if <tt>LogFormat</tt> is configured correctly in
<tt>/etc/httpd/conf/httpd.conf</tt>, run the following command:
<pre>$ grep -i logformat /etc/httpd/conf/httpd.conf</pre>
The output should contain the following:
<pre>LogFormat "a %A %h %H %l %m %s %t %u %U \"%{Referer}i\" \"%{User-Agent}i\"" combined</pre>
</ocil>
<rationale>
The server error logs are invaluable because they can also be used to identify
potential problems and enable proactive remediation. Log data can reveal
anomalous behavior such as "not found" or "unauthorized" errors that may
be an evidence of attack attempts. Failure to enable error logging can
significantly reduce the ability of Web Administrators to detect or remediate
problems. The LogFormat directive defines the format and information to be
included in the access log entries.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_log_format"/>
<ref disa="" nist="" srg="" stigid="WA00612"/>
</Rule>

<Rule id="httpd_enable_system_logging" severity="medium" prodtype="rhel7">
<title>Enable HTTPD System Logging</title>
<description>
<tt>CustomLog</tt> should be enabled and set to the following in
<tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>CustomLog "logs/access_log" combined</pre>
</description>
<ocil clause="it is not">
To verify if <tt>CustomLog</tt> is configured correctly in
<tt>/etc/httpd/conf/httpd.conf</tt>, run the following command:
<pre>$ grep -i customlog /etc/httpd/conf/httpd.conf</pre>
The output should return the following:
<pre>CustomLog "logs/access_log" combined</pre>
</ocil>
<rationale>
The server error logs are invaluable because they can also be used to identify
potential problems and enable proactive remediation. Log data can reveal
anomalous behavior such as "not found" or "unauthorized" errors that may
be an evidence of attack attempts. Failure to enable error logging can
significantly reduce the ability of Web Administrators to detect or remediate
problems. The CustomLog directive specifies the log file, syslog facility, or
piped logging utility.
</rationale>
<ident cce=""/>
<oval id="httpd_enable_system_logging"/>
<ref disa="" nist="" srg="" stigid="WA00615"/>
</Rule>

<Rule id="httpd_enable_loglevel" severity="medium" prodtype="rhel7">
<title>Enable HTTPD LogLevel</title>
<description>
<tt>LogLevel</tt> should be enabled and set to <sub idref="var_httpd_loglevel" />.
Add or edit the following in <tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>LogLevel <sub idref="var_httpd_loglevel" /></pre>
</description>
<ocil clause="it is not">
To verify if <tt>LogLevel</tt> is configured correctly in
<tt>/etc/httpd/conf/httpd.conf</tt>, run the following command:
<pre>$ grep -i loglevel /etc/httpd/conf/httpd.conf</pre>
The command should return the following:
<pre>LogLevel warn</pre>
</ocil>
<rationale>
The server error logs are invaluable because they can also be used to identify
potential problems and enable proactive remediation. Log data can reveal
anomalous behavior such as "not found" or "unauthorized" errors that may
be an evidence of attack attempts. Failure to enable error logging can
significantly reduce the ability of Web Administrators to detect or remediate
problems. While the ErrorLog directive configures the error log file name, the
LogLevel directive is used to configure the severity level for the error logs.
The log level values are the standard syslog levels: emerg, alert, crit, error,
warn, notice, info and debug.
</rationale>
<ident cce=""/>
<oval id="httpd_enable_loglevel" value="var_httpd_loglevel" />
<ref disa="" nist="" srg="" stigid="WA00620"/>
</Rule>

<Rule id="httpd_configure_max_keepalive_requests" severity="medium" prodtype="rhel7">
<title>Configure The Number of Allowed Simultaneous Requests</title>
<description>
The <tt>MaxKeepAliveRequests</tt> directive should be set and configured to
<sub idref="var_max_keepalive_requests" /> or greater by setting the following
in <tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>MaxKeepAliveRequests <sub idref="var_max_keepalive_requests" /></pre>
</description>
<ocil clause="it is not">
To verify if <tt>MaxKeepAliveRequests</tt> is configured correctly in
<tt>/etc/httpd/conf/httpd.conf</tt>, run the following command:
<pre>$ grep -i maxkeepaliverequests /etc/httpd/conf/httpd.conf</pre>
The command should return the following:
<pre>MaxKeepAliveRequests 100</pre>
</ocil>
<rationale>
Resource exhaustion can occur when an unlimited number of concurrent requests
are allowed on a web site, facilitating a denial of service attack. Mitigating
this kind of attack will include limiting the number of concurrent HTTP/HTTPS
requests per IP address and may include, where feasible, limiting parameter
values associated with keepalive, (i.e., a parameter used to limit the amount of
time a connection may be inactive).
</rationale>
<ident cce=""/>
<oval id="httpd_configure_max_keepalive_requests" value="var_max_keepalive_requests"/>
<ref disa="" nist="" srg="" stigid="WG110"/>
</Rule>

<Group id="httpd_restrict_info_leakage">
<title>Restrict Web Server Information Leakage</title>
<description>
The <tt>ServerTokens</tt> and <tt>ServerSignature</tt> directives determine how
much information the web server discloses about the configuration of the
system.</description>

<Rule id="httpd_servertokens_prod" prodtype="rhel7">
<title>Set httpd <tt>ServerTokens</tt> Directive to <tt>Prod</tt></title>
<description>
<tt>ServerTokens Prod</tt> restricts information in page headers, returning only the word "Apache."
<br /><br />
Add or correct the following directive in <tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>ServerTokens Prod</pre>
</description>
<rationale>
Information disclosed to clients about the configuration of the web server and system could be used
to plan an attack on the given system. This information disclosure should be restricted to a minimum.
</rationale>
<ref nist="CM-7" />
<ident prodtype="rhel7" cce="80302-3" />
</Rule>

<Rule id="httpd_serversignature_off" prodtype="rhel7">
<title>Set httpd <tt>ServerSignature</tt> Directive to <tt>Off</tt></title>
<description>
<tt>ServerSignature Off</tt> restricts <tt>httpd</tt> from displaying server version number
on error pages.
<br /><br />
Add or correct the following directive in <tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>ServerSignature Off</pre>
</description>
<rationale>
Information disclosed to clients about the configuration of the web server and system could be used
to plan an attack on the given system. This information disclosure should be restricted to a minimum.
</rationale>
<ident prodtype="rhel7" cce="80303-1" />
<ref nist="CM-7" />
</Rule>

</Group> <!-- <Group id="httpd_restrict_info_leakage"> -->

<Group id="httpd_minimize_loadable_modules">
<title>Minimize Web Server Loadable Modules</title>
<description>
A default installation of <tt>httpd</tt> includes a plethora of dynamically shared objects (DSO)
that are loaded at run-time. Unlike the aforementioned compiled-in modules, a DSO can be
disabled in the configuration file by removing the corresponding LoadModule directive.
<br /><br />
Note: A DSO only provides additional functionality if associated directives are included
in the <tt>httpd</tt> configuration file. It should also be noted that removing a DSO will produce
errors on <tt>httpd</tt> startup if the configuration file contains directives that apply to that
module. Refer to <tt><weblink-macro link="http://httpd.apache.org/docs/"/></tt> for details on which directives
are associated with each DSO.
<br /><br />
Following each DSO removal, the configuration can be tested with the following command
to check if everything still works:
<pre>$ sudo service httpd configtest</pre>
The purpose of each of the modules loaded by default will now be addressed one at a time.
If none of a module's directives are being used, remove it.
</description>

<Group id="httpd_core_modules">
<title><tt>httpd</tt> Core Modules</title>
<description>
These modules comprise a basic subset of modules that are likely needed for base <tt>httpd</tt>
functionality; ensure they are not commented out in <tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>LoadModule auth_basic_module modules/mod_auth_basic.so
LoadModule authn_default_module modules/mod_authn_default.so
LoadModule authz_host_module modules/mod_authz_host.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_default_module modules/mod_authz_default.so
LoadModule log_config_module modules/mod_log_config.so
LoadModule logio_module modules/mod_logio.so
LoadModule setenvif_module modules/mod_setenvif.so
LoadModule mime_module modules/mod_mome.so
LoadModule autoindex_module modules/mod_autoindex.so
LoadModule negotiation_module modules/mod_negotiation.so
LoadModule dir_module modules/mod_dir.so
LoadModule alias_module modules/mod_alias.so</pre>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</description>

<Rule id="httpd_enable_log_config" severity="medium" prodtype="rhel7">
<title>Enable log_config_module For HTTPD Logging</title>
<description>
The <tt>log_config_module</tt> should exist and be configured in
the <tt>/etc/httpd/conf/httpd.conf</tt> file by adding the following module to
configure logging:
<pre>log_config_module</pre>
</description>
<ocil clause="it is not">
To verify that the <tt>log_config_module</tt> exists in
<tt>/etc/httpd/conf/httpd.conf</tt>, run the following command:
<pre>$ grep log_config_module /etc/httpd/conf/httpd.conf</pre>
The output should return:
<pre>&lt;IfModule log_config_module&gt;</pre>
</ocil>
<rationale>
A major tool in exploring the web site use, attempted use, unusual conditions,
and problems are reported in the access and error logs. In the event of a
security incident, these logs can provide the SA and the web manager with
valuable information. Without these log files, SAs and web managers are
seriously hindered in their efforts to respond appropriately to suspicious or
criminal actions targeted at the web site.
</rationale>
<ident cce=""/>
<oval id="httpd_enable_log_config"/>
<ref disa="" nist="" srg="" stigid="WG240"/>
</Rule>

<Group id="httpd_basic_authentication">
<title>Minimize Modules for HTTP Basic Authentication</title>
<description>
The following modules are necessary if this web server will provide content that will
be restricted by a password.
<br /><br />
Authentication can be performed using local plain text password files (<tt>authn_file</tt>),
local DBM password files (<tt>authn_dbm</tt>) or an LDAP directory. The only module required by
the web server depends on your choice of authentication. Comment out the modules you don't
need from the following:
<pre>LoadModule authn_file_module modules/mod_authn_file.so
LoadModule authn_dbm_module modules/mod_authn_dbm.so</pre>
<tt>authn_alias</tt> allows for authentication based on aliases. <tt>authn_anon</tt>
allows anonymous authentication similar to that of anonymous ftp sites. <tt>authz_owner</tt>
allows authorization based on file ownership. <tt>authz_dbm</tt> allows for authorization
based on group membership if the web server is using DBM authentication.
<br /><br />
If the above functionality is unnecessary, comment out the related module:
<pre>#LoadModule authn_alias_module modules/mod_authn_alias.so
#LoadModule authn_anon_module modules/mod_authn_anon.so
#LoadModule authz_owner_module modules/mod_authz_owner.so
#LoadModule authz_dbm_module modules/mod_authz_dbm.so</pre>
</description>
</Group>

<Rule id="httpd_digest_authentication" prodtype="rhel7">
<title>Disable HTTP Digest Authentication</title>
<description>
The <tt>auth_digest</tt> module provides encrypted authentication sessions.
If this functionality is unnecessary, comment out the related module:
<pre>#LoadModule auth_digest_module modules/mod_auth_digest.so</pre>
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80304-9" />
</Rule>

<Rule id="httpd_mod_rewrite" prodtype="rhel7">
<title>Disable HTTP mod_rewrite</title>
<description>
The <tt>mod_rewrite</tt> module is very powerful and can protect against
certain classes of web attacks. However, it is also very complex and has a
significant history of vulnerabilities itself. If its functionality is
unnecessary, comment out the related module:
<pre>#LoadModule rewrite_module modules/mod_rewrite.so</pre>
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80305-6" />
</Rule>

<Rule id="httpd_ldap_support" prodtype="rhel7">
<title>Disable LDAP Support</title>
<description>
The <tt>ldap</tt> module provides HTTP authentication via an LDAP directory.
If its functionality is unnecessary, comment out the related modules:
<pre>#LoadModule ldap_module modules/mod_ldap.so
#LoadModule authnz_ldap_module modules/mod_authnz_ldap.so</pre>
If LDAP is to be used, SSL encryption should be used as well.
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80306-4" />
</Rule>

<Rule id="httpd_server_side_includes" prodtype="rhel7">
<title>Disable Server Side Includes</title>
<description>
Server Side Includes provide a method of dynamically generating web pages through the
insertion of server-side code. However, the technology is also deprecated and
introduces significant security concerns.
If this functionality is unnecessary, comment out the related module:
<pre>#LoadModule include_module modules/mod_include.so</pre>
If there is a critical need for Server Side Includes, they should be enabled with the
option <tt>IncludesNoExec</tt> to prevent arbitrary code execution. Additionally, user
supplied data should be encoded to prevent cross-site scripting vulnerabilities.
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80307-2" />
</Rule>

<Rule id="httpd_mime_magic" prodtype="rhel7">
<title>Disable MIME Magic</title>
<description>
The <tt>mime_magic</tt> module provides a second layer of MIME support that in most configurations
is likely extraneous. If its functionality is unnecessary, comment out the related module:
<pre>#LoadModule mime_magic_module modules/mod_mime_magic.so</pre>
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80308-0" />
</Rule>

<Rule id="httpd_webdav" prodtype="rhel7">
<title>Disable WebDAV (Distributed Authoring and Versioning)</title>
<description>
WebDAV is an extension of the HTTP protocol that provides distributed and
collaborative access to web content. If its functionality is unnecessary,
comment out the related modules:
<pre>#LoadModule dav_module modules/mod_dav.so
#LoadModule dav_fs_module modules/mod_dav_fs.so</pre>
If there is a critical need for WebDAV, extra care should be taken in its configuration.
Since DAV access allows remote clients to manipulate server files, any location on the
server that is DAV enabled should be protected by access controls.
</description>
<rationale>
Minimizing the number of loadable modules available to the web server, reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80309-8" />
</Rule>

<Rule id="httpd_server_activity_status" prodtype="rhel7">
<title>Disable Server Activity Status</title>
<description>
The <tt>status</tt> module provides real-time access to statistics on the internal operation of
the web server. This may constitute an unnecessary information leak and should be disabled
unless necessary. To do so, comment out the related module:
<pre>#LoadModule status_module modules/mod_status.so</pre>
If there is a critical need for this module, ensure that access to the status
page is properly restricted to a limited set of hosts in the status handler
configuration.
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80310-6" />
</Rule>

<Rule id="httpd_server_configuration_display" prodtype="rhel7">
<title>Disable Web Server Configuration Display</title>
<description>
The <tt>info</tt> module creates a web page illustrating the configuration of the web server. This
can create an unnecessary security leak and should be disabled.
If its functionality is unnecessary, comment out the module:
<pre>#LoadModule info_module modules/mod_info.so</pre>
If there is a critical need for this module, use the <tt>Location</tt> directive to provide
an access control list to restrict access to the information.
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80311-4" />
</Rule>

<Rule id="httpd_url_correction" prodtype="rhel7">
<title>Disable URL Correction on Misspelled Entries</title>
<description>
The <tt>speling</tt> module attempts to find a document match by allowing one misspelling in an
otherwise failed request. If this functionality is unnecessary, comment out the module:
<pre>#LoadModule speling_module modules/mod_speling.so</pre>
This functionality weakens server security by making site enumeration easier.
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80312-2" />
</Rule>

<Rule id="httpd_proxy_support" prodtype="rhel7">
<title>Disable Proxy Support</title>
<description>
The <tt>proxy</tt> module provides proxying support, allowing <tt>httpd</tt> to forward requests and
serve as a gateway for other servers. If its functionality is unnecessary, comment out the module:
<pre>#LoadModule proxy_module modules/mod_proxy.so</pre>
<!-- dependencies: #LoadModule proxy_balancer_module modules/mod_proxy_balancer.so
#LoadModule proxy_ftp_module modules/mod_proxy_ftp.so
#LoadModule proxy_http_module modules/mod_proxy_http.so
#LoadModule proxy_connect_module modules/mod_proxy_connect.so-->
If proxy support is needed, load <tt>mod_proxy</tt> and the appropriate proxy protocol handler
module (one of <tt>mod_proxy_http</tt>, <tt>mod_proxy_ftp</tt>, or <tt>mod_proxy_connect</tt>). Additionally,
make certain that a server is secure before enabling proxying, as open proxy servers
are a security risk. <tt>mod_proxy_balancer</tt> enables load balancing, but requires that
<tt>mod status</tt> be enabled.
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80313-0" />
</Rule>

<Rule id="httpd_cache_support" prodtype="rhel7">
<title>Disable Cache Support</title>
<description>
The <tt>cache</tt> module allows <tt>httpd</tt> to cache data, optimizing access to
frequently accessed content. However, it introduces potential security flaws
such as the possibility of circumventing <tt>Allow</tt> and
<tt>Deny</tt> directives.
<br /><br /> If this functionality is
unnecessary, comment out the module:
<pre>#LoadModule cache_module modules/mod_cache.so</pre>
If caching is required, it should not be enabled for any limited-access content.
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80314-8" />
</Rule>

<Rule id="httpd_cgi_support" prodtype="rhel7">
<title>Disable CGI Support</title>
<description>
The <tt>cgi</tt> module allows HTML to interact with the CGI web programming language.
<br /><br />
If this functionality is unnecessary, comment out the module:
<pre>#LoadModule cgi_module modules/mod_cgi.so</pre>
<!--#LoadModule env_module modules/mod_env.so
#LoadModule actions_module modules/mod_actions.so
#LoadModule suexec_module modules/mod_suexec.so -->
If the web server requires the use of CGI, enable <tt>mod_cgi</tt>.
<!-- If extended
CGI functionality is required, include the appropriate modules. <tt>env</tt> allows for
control of the environment passed to CGI scripts. <tt>actions</tt> allows CGI events
to be triggered when files of a certain type are requested. <tt>su exec</tt> allows
CGI scripts to run as a specified user/group instead of as the server's user/group. -->
</description>
<rationale>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80315-5" />
</Rule>

<Group id="httpd_optional_components">
<title>Minimize Various Optional Components</title>
<description>
The following modules perform very specific tasks, sometimes providing access to
just a few additional directives. If such functionality is not required (or if you
are not using these directives), comment out the associated module:
<ul>
<li>External filtering (response passed through external program prior to client delivery)
<pre>#LoadModule ext_filter_module modules/mod_ext_filter.so</pre></li>
<li>User-specified Cache Control and Expiration
<pre>#LoadModule expires_module modules/mod_expires.so</pre></li>
<li>Compression Output Filter (provides content compression prior to client delivery)
<pre>#LoadModule deflate_module modules/mod_deflate.so</pre></li>
<li>HTTP Response/Request Header Customization
<pre>#LoadModule headers_module modules/mod_headers.so</pre></li>
<li>User activity monitoring via cookies
<pre>#LoadModule usertrack_module modules/mod_usertrack.so</pre></li>
<li>Dynamically configured mass virtual hosting
<pre>#LoadModule vhost_alias_module modules/mod_vhost_alias.so</pre></li>
</ul>
Minimizing the number of loadable modules available to the web server reduces risk
by limiting the capabilities allowed by the web server.
</description>
</Group>

<Group id="httpd_minimize_config_files_included">
<title>Minimize Configuration Files Included</title>
<description>
The <tt>Include</tt> directive directs <tt>httpd</tt> to load supplementary configuration files
from a provided path. The default configuration loads all files that end in <tt>.conf</tt>
from the <tt>/etc/httpd/conf.d</tt> directory.
<br /><br />
To restrict excess configuration, the following line should be commented out and
replaced with <tt>Include</tt> directives that only reference required configuration files:
<pre>#Include conf.d/*.conf</pre>
If the above change was made, ensure that the SSL encryption remains loaded by
explicitly including the corresponding configuration file:
<pre>Include conf.d/ssl.conf</pre>
If PHP is necessary, a similar alteration must be made:
<pre>Include conf.d/php.conf</pre>
<!--<rationale>-->
Explicitly listing the configuration files to be loaded during web server start-up avoids
the possibility of unwanted or malicious configuration files to be automatically included as
part of the server's running configuration.
<!--</rationale>-->
</description>
</Group>

</Group> <!-- <Group id="httpd_core_modules"> -->

</Group> <!-- <Group id="httpd_minimize_loadable_modules"> -->

<Group id="httpd_directory_restrictions">
<title>Directory Restrictions</title>
<description>
The Directory tags in the web server configuration file allow finer grained access
control for a specified directory. All web directories should be configured on a
case-by-case basis, allowing access only where needed.
</description>

<Rule id="httpd_disable_anonymous_ftp_access" severity="medium" prodtype="rhel7">
<title>Disable Anonymous FTP Access</title>
<description>
If any directories that contain dynamic scripts can be accessed via FTP by
any group or user that does not require access, remove permissions to such
directories that allow anonymous access. Also, ensure that any such
access employs an encrypted connection.
</description>
<ocil clause="it is not">
Locate the directories containing the CGI scripts. These directories should be
language-specific (e.g., PERL, ASP, JS, JSP, etc.). Examine the file permissions
on the directories using the following command:
<pre>ls -l <i>directories</i></pre>
Anonymous FTP users must not have access to these directories.
</ocil>
<rationale>
The directories containing the CGI scripts, such as PERL, must not be
accessible to anonymous users via FTP. This applies to all directories that
contain scripts that can dynamically produce web pages in an interactive manner
(i.e., scripts based upon user-provided input). Such scripts contain information
that could be used to compromise a web service, access system resources, or
deface a web site.
</rationale>
<ident cce=""/>
<oval id="httpd_disable_anonymous_ftp_access"/>
<ref disa="" nist="" srg="" stigid="WG430"/>
</Rule>

<Rule id="httpd_ignore_htaccess_files" severity="medium" prodtype="rhel7">
<title>Ignore HTTPD .htaccess Files</title>
<description>
Set <tt>AllowOverride</tt> to <tt>none</tt> for each instant of
<tt>&lt;Directory&gt;</tt>.
</description>
<ocil clause="it is not">
To preclude access to the servers root directory, ensure the following
directive is in the <tt>httpd.conf</tt> file. This entry will also stop users
from setting up <tt>.htaccess</tt> files which can override security features
configured in <tt>/etc/httpd/conf/httpd.conf</tt>.
<pre>AllowOverride none</pre>
</ocil>
<rationale>
CGI scripts represents one of the most common and exploitable means of
compromising a web server. By definition, CGI are executable by the operating
system of the host server. While access control is provided via the web service,
the execution of CGI programs is not otherwise limited unless the SA or Web
Manager takes specific measures. CGI programs can access and alter data files,
launch other programs and use the network. CGI programs can be written in any
available programming language. C, PERL, PHP, Javascript, VBScript and shell
(sh, ksh, bash) are popular choices.
</rationale>
<ident cce=""/>
<oval id="httpd_ignore_htaccess_files"/>
<ref disa="" nist="" srg="" stigid="WG400"/>
</Rule>

<Rule id="httpd_anonymous_content_sharing" severity="medium" prodtype="rhel7">
<title>Web Content Directories Must Not Be Shared Anonymously</title>
<description>
Web content directories should not be shared anonymously over remote filesystems
such as <tt>nfs</tt> and <tt>smb</tt>. Remove the shares from the applicable
directories.
</description>
<ocil clause="it is not">
To verify that web content directories should not be shared anonymously over
remote filesystems such as <tt>nfs</tt> and <tt>smb</tt>, inspect each instance
of <tt>DocumentRoot</tt> and <tt>serverRoot</tt> and verify that no entry in
<tt>/etc/fstab</tt> exists or no remote filesystem process is running for
any instance.
<pre>$ ps -ef | grep "nfs\|smb"</pre>
</ocil>
<rationale>
Sharing web content is a security risk when a web server is involved. Users
accessing the share anonymously could experience privileged access to the
content of such directories. Network sharable directories expose those
directories and their contents to unnecessary access. Any unnecessary exposure
increases the risk that someone could exploit that access and either compromises
the web content or cause web server performance problems.
</rationale>
<ident cce=""/>
<oval id="httpd_anonymous_content_sharing"/>
<ref disa="" nist="" srg="" stigid="WG210"/>
</Rule>

<Rule id="httpd_configure_script_permissions" severity="high" prodtype="rhel7">
<title>Remove Write Permissions From Filesystem Paths And Server Scripts</title>
<description>
Configure permissions for each instance of <tt>Alias</tt>,
<tt>ScriptAlias</tt>, and <tt>ScriptAliasMatch</tt> that exist.
<pre>$ sudo find <i>DIR</i> -type d -exec chmod 755 {} \;
$ sudo find <i>DIR</i> -type f -exec chmod 555 {} \;</pre>
Where <i>DIR</i> matches the paths from <tt>Alias</tt>,
<tt>ScriptAlias</tt>, and <tt>ScriptAliasMatch</tt>.
</description>
<ocil clause="it is not">
Verify that the files and directories of each instance of <tt>Alias</tt>,
<tt>ScriptAlias</tt>, and <tt>ScriptAliasMatch</tt> that exist
have the correct file and directory permissions applied.
</ocil>
<rationale>
Excessive permissions for the anonymous web user account are one of the most
common faults contributing to the compromise of a web server. If this user is
able to upload and execute files on the web server, the organization or owner of
the server will no longer have control of the asset.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_script_permissions"/>
<ref disa="" nist="" srg="" stigid="WG290"/>
</Rule>

<Rule id="httpd_restrict_root_directory" prodtype="rhel7">
<title>Restrict Root Directory</title>
<description>
The <tt>httpd</tt> root directory should always have the most restrictive configuration enabled.
<pre>&lt;Directory / &gt;
   Options None
   AllowOverride None
   Order allow,deny
&lt;/Directory&gt;</pre>
</description>
<rationale>
The Web Server's root directory content should be protected from unauthorized access
by web clients.
</rationale>
<ident prodtype="rhel7" cce="80316-3" />
</Rule>

<Rule id="httpd_restrict_web_directory" prodtype="rhel7">
<title>Restrict Web Directory</title>
<description>
The default configuration for the web (<tt>/var/www/html</tt>) Directory allows directory
indexing (<tt>Indexes</tt>) and the following of symbolic links (<tt>FollowSymLinks</tt>).
Neither of these is recommended.
<br /><br />
The <tt>/var/www/html</tt> directory hierarchy should not be viewable via the web, and
symlinks should only be followed if the owner of the symlink also owns the linked file.
<br /><br />
Ensure that this policy is adhered to by altering the related section of the configuration:
<pre>&lt;Directory "/var/www/html"&gt;
#  ...
   Options SymLinksIfOwnerMatch
#  ...
&lt;/Directory&gt;</pre>
</description>
<rationale>
Access to the web server's directory hierarchy could allow access to unauthorized files
by web clients. Following symbolic links could also allow such access.
</rationale>
<ident prodtype="rhel7" cce="80317-1" />
</Rule>

<Rule id="httpd_restrict_critical_directories" prodtype="rhel7">
<title>Restrict Other Critical Directories</title>
<description>
All accessible web directories should be configured with similarly restrictive settings.
The <tt>Options</tt> directive should be limited to necessary functionality and the <tt>AllowOverride</tt>
directive should be used only if needed. The <tt>Order</tt> and <tt>Deny</tt> access control tags
should be used to deny access by default, allowing access only where necessary.
</description>
<rationale>
Directories accessible from a web client should be configured with the least amount of
access possible in order to avoid unauthorized access to restricted content or server information.
</rationale>
<ident prodtype="rhel7" cce="80318-9" />
</Rule>

<Rule id="httpd_limit_available_methods" prodtype="rhel7">
<title>Limit Available Methods</title>
<description>
Web server methods are defined in section 9 of RFC 2616 (<weblink-macro link="http://www.ietf.org/rfc/rfc2616.txt"/>).
If a web server does not require the implementation of all available methods,
they should be disabled.
<br /><br />
Note: <tt>GET</tt> and <tt>POST</tt> are the most common methods. A majority of the others
are limited to the WebDAV protocol.
<pre>&lt;Directory /var/www/html&gt;
# ...
   # Only allow specific methods (this command is case-sensitive!)
   &lt;LimitExcept GET POST&gt;
      Order allow,deny
   &lt;/LimitExcept&gt;
# ...
&lt;/Directory&gt;</pre>
</description>
<rationale>
Minimizing the number of available methods to the web client reduces risk
by limiting the capabilities allowed by the web server.
</rationale>
<ident prodtype="rhel7" cce="80319-7" />
</Rule>

</Group> <!-- <Group id="httpd_directory_restrictions"> -->

<Group id="httpd_modules_improve_security">
<title>Use Appropriate Modules to Improve <tt>httpd</tt>'s Security</title>
<description>
Among the modules available for <tt>httpd</tt> are several whose use may improve the
security of the web server installation. This section recommends and discusses
the deployment of security-relevant modules.
</description>

<Group id="httpd_deploy_mod_ssl">
<title>Deploy <tt>mod_ssl</tt></title>
<description>
Because HTTP is a plain text protocol, all traffic is susceptible to passive
monitoring. If there is a need for confidentiality, SSL should be configured
and enabled to encrypt content.
<br /><br />
Note: <tt>mod_nss</tt> is a FIPS 140-2 certified alternative to <tt>mod_ssl</tt>.
The modules share a considerable amount of code and should be nearly identical
in functionality. If FIPS 140-2 validation is required, then <tt>mod_nss</tt> should
be used. If it provides some feature or its greater compatibility is required,
then <tt>mod_ssl</tt> should be used.
</description>

<Rule id="httpd_install_mod_ssl" prodtype="rhel7">
<title>Install <tt>mod_ssl</tt></title>
<description>
Install the <tt>mod_ssl</tt> module:
<pre>$ sudo yum install mod_ssl</pre>
</description>
<rationale>
<tt>mod_ssl</tt> provides encryption capabilities for the <tt>httpd</tt> Web server. Unencrypted
content is transmitted in plain text which could be passively monitored and accessed by
unauthorized parties.
</rationale>
<ident prodtype="rhel7" cce="80320-5" />
</Rule>

<Rule id="httpd_configure_tls" severity="medium" prodtype="rhel7">
<title>Enable Transport Layer Security (TLS) Encryption</title>
<description>
Disable old SSL and TLS version and enable the latest TLS encryption by setting
the following in <tt>/etc/httpd/conf.modules.d/ssl.conf</tt>:
<pre>SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1</pre>
Make sure to also set <tt>SSLEngine</tt> to <tt>on</tt> in
<tt>/etc/httpd/conf.modules.d/ssl.conf</tt> like the following:
<pre>SSLEngine on</pre>
</description>
<ocil clause="it is not">
To verify that TLS is configured properly in
<tt>/etc/httpd/conf.modules.d/ssl.conf</tt>, run the following command:
<pre>$ grep -i "sslengine\|sslprotocol" /etc/httpd/conf.d/ssl.conf</pre>
The output should return the following:
<pre>
SSLEngine on
SSLProtocol all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1
</pre>
</ocil>
<rationale>
Transport Layer Security (TLS) encryption is a required security setting for a
private web server. Encryption of private information is essential to ensuring
data confidentiality. If private information is not encrypted, it can be
intercepted and easily read by an unauthorized party. A web server must
use a FIPS 140-2 approved TLS version, and all non-FIPS-approved SSL versions
must be disabled.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_tls"/>
<ref disa="" nist="" srg="" stigid="WG340"/>
</Rule>

<Rule id="httpd_require_client_certs" severity="medium" prodtype="rhel7">
<title>Require Client Certificates</title>
<description>
<tt>SSLVerifyClient</tt> should be set and configured to <tt>require</tt> by
setting the following in <tt>/etc/httpd/conf/httpd.conf</tt>:
<pre>SSLVerifyClient require</pre>
</description>
<ocil clause="it is not">
To verify if <tt>SSLVerifyClient</tt> is configured correctly in
<tt>/etc/httpd/conf/httpd.conf</tt>, run the following command:
<pre>$ grep -i sslverifyclient /etc/httpd/conf/httpd.conf</pre>
The command should return the following:
<pre>SSLVerifyClient require</pre>
</ocil>
<rationale>
Web sites requiring authentication within the DoD must utilize PKI as an
authentication mechanism for web users. Information systems residing behind web
servers requiring authorization based on individual identity must use the
identity provided by certificate-based authentication to support access control
decisions.
</rationale>
<ident cce=""/>
<oval id="httpd_require_client_certs"/>
<ref disa="" nist="" srg="" stigid="WG140"/>
</Rule>

<Rule id="httpd_configure_valid_server_cert" severity="medium" prodtype="rhel7">
<title>Configure A Valid Server Certificate</title>
<description>
Configure the web site to use a valid organizationally defined certificate.
For DoD, this is a DoD server certificate issued by the DoD CA.
</description>
<ocil clause="it is not">
Open browser window and browse to the appropriate site. Before entry to the
site, you should be presented with the server's PKI credentials. Review
these credentials for authenticity.
<br/><br/>
For DoD, find an entry which cites:
<pre>
Issuer:
CN =
DOD CLASS 3 CA-3
OU = PKI
OU = DoD
O = U.S. Government
C = US
</pre>
</ocil>
<rationale>
This check verifies that DoD is a hosted web site's CA. The certificate is
actually a DoD-issued server certificate used by the organization being
reviewed. This is used to verify the authenticity of the web site to the user.
If the certificate is not for the server (Certificate belongs to), if the
certificate is not issued by DoD (Certificate was issued by), or if the current
date is not included in the valid date (Certificate is valid from), then there
is no assurance that the use of the certificate is valid. The entire purpose of
using a certificate is, therefore, compromised.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_valid_server_cert"/>
<ref disa="" nist="" srg="" stigid="WG350"/>
</Rule>

</Group> <!-- <Group id="httpd_deploy_mod_ssl"> -->

<Group id="httpd_deploy_mod_security">
<title>Deploy <tt>mod_security</tt></title>
<description>
The <tt>security</tt> module provides an application level firewall for <tt>httpd</tt>.
Following its installation with the base ruleset, specific configuration advice can be found at
<weblink-macro link="http://www.modsecurity.org/"/> to design a policy that best matches the security needs of
the web applications. Usage of <tt>mod_security</tt> is highly recommended for some environments,
but it should be noted this module does not ship with Red Hat Enterprise Linux itself,
and instead is provided via Extra Packages for Enterprise Linux (EPEL).
For more information on EPEL please refer to http://fedoraproject.org/wiki/EPEL.
</description>

<Rule id="httpd_install_mod_security" prodtype="rhel7">
<title>Install <tt>mod_security</tt></title>
<description>
Install the <tt>security</tt> module:
<pre>$ sudo yum install mod_security</pre>
<!-- this is in EPEL and this rule should not be included in any RHEL-only baselines -->
</description>
<rationale>
<tt>mod_security</tt> provides an additional level of protection for the web server by
enabling the administrator to implement content access policies and filters at the
application layer.
</rationale>
<ident prodtype="rhel7" cce="80321-3" />
</Rule>

</Group> <!-- <Group id="httpd_deploy_mod_security"> -->

</Group> <!-- <Group id="httpd_modules_improve_security"> -->

<Group id="httpd_use_dos_protection_modules">
<title>Use Denial-of-Service Protection Modules</title>
<description>
Denial-of-service attacks are difficult to detect and prevent while maintaining
acceptable access to authorized users. However, some traffic-shaping
modules can be used to address the problem. Well-known DoS protection modules include:
<pre>mod_cband mod_bwshare mod_limitipconn mod_evasive</pre>
Denial-of-service prevention should be implemented for a web server if such a threat exists.
However, specific configuration details are very dependent on the environment and often best left
at the discretion of the administrator.
</description>
</Group> <!-- <Group id="httpd_use_dos_protection_modules"> -->

<Group id="httpd_configure_php_securely">
<title>Configure PHP Securely</title>
<description>
PHP is a widely-used and often misconfigured server-side scripting language. It should
be used with caution, but configured appropriately when needed.
<br /><br />
Review <tt>/etc/php.ini</tt> and make the following changes if possible:
<pre># Do not expose PHP error messages to external users
display_errors = Off

# Enable safe mode
safe_mode = On

# Only allow access to executables in isolated directory
safe_mode_exec_dir = php-required-executables-path

# Limit external access to PHP environment
safe_mode_allowed_env_vars = PHP_

# Restrict PHP information leakage
expose_php = Off

# Log all errors
log_errors = On

# Do not register globals for input data
register_globals = Off

# Minimize allowable PHP post size
post_max_size = 1K

# Ensure PHP redirects appropriately
cgi.force_redirect = 0

# Disallow uploading unless necessary
file_uploads = Off

# Disallow treatment of file requests as fopen calls
allow_url_fopen = Off

# Enable SQL safe mode
sql.safe_mode = On
</pre>
</description>

</Group> <!-- <Group id="httpd_configure_php_securely"> -->

<Group id="httpd_configure_perl_securely">
<title>Configure PHP Securely</title>
<description>
PERL (Practical Extraction and Report Language) is an interpreted language
optimized for scanning arbitrary text files, extracting information from those
text files, and printing reports based on that information. The language is
often used in shell scripting and is intended to be practical, easy to use, and
efficient means of generating interactive web pages for the user.
</description>

<Rule id="httpd_configure_perl_taint" severity="medium" prodtype="rhel7">
<title>Configure HTTP PERL Scripts To Use TAINT Option</title>
<description>
If the <tt>mod_perl</tt> module is installed, enable Perl Taint checking in
<tt>/etc/httpd/conf/httpd.conf</tt>. To enable Perl Taint
checking, add or uncomment the following to <tt>/etc/httpd/conf.d/perl.conf</tt>:
<pre>PerlSwitches -T</pre>
</description>
<ocil clause="it is not">
To verify if the <tt>mod_perl</tt> is installed, run the following command:
<pre>$ rpm -qa | grep mod_perl</pre>
If the <tt>mod_perl</tt> module is installed, verify that <tt>PerlSwitches -T</tt>
is enabled in <tt>/etc/httpd/conf.d/perl.conf</tt> by running the following
command:
<pre>$ grep -i "PerlSwitches -T" /etc/httpd/conf.d/perl.conf</pre>
The output should return uncommented:
<pre>PerlSwitches -T</pre>
</ocil>
<rationale>
PERL (Practical Extraction and Report Language) is an interpreted language
optimized for scanning arbitrary text files, extracting information from those
text files, and printing reports based on that information. The language is
often used in shell scripting and is intended to be practical, easy to use, and
efficient means of generating interactive web pages for the user. Unfortunately,
many widely available freeware PERL programs (scripts) are extremely insecure.
This is most readily accomplished by a malicious user substituting input to a
PERL script during a POST or a GET operation.
<br/><br/>
Consequently, the founders of
PERL have developed a mechanism named TAINT that protects the system from
malicious input sent from outside the program. When the data is tainted, it
cannot be used in programs or functions such as eval(), system(), exec(), pipes,
or popen(). The script will exit with a warning message.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_perl_taint"/>
<ref disa="" nist="" srg="" stigid="WG460"/>
</Rule>

</Group> <!-- <Group id="httpd_configure_perl_securely"> -->

<Group id="httpd_configure_os_protect_web_server">
<title>Configure Operating System to Protect Web Server</title>
<description>
The following configuration steps should be taken on the system which hosts the
web server, in order to provide as safe an environment as possible for the web server.
</description>

<Rule id="httpd_configure_remote_session_encryption" severity="high" prodtype="rhel7">
<title>Ensure Remote Administrative Access Is Encrypted</title>
<description>
Ensure that the SSH server service is enabled.
<systemd-service-macro enable="true" service="sshd" />
</description>
<ocil>
<systemd-check-macro enable="true" service="sshd" />
</ocil>
<rationale>
Logging into a web server remotely using an unencrypted protocol or service
when performing updates and maintenance is a major risk. Data, such as user
account, is transmitted in plaintext and can easily be compromised. When
performing remote administrative tasks, a protocol or service that encrypts the
communication channel must be used.
<br/><br/>
An alternative to remote administration of
the web server is to perform web server administration locally at the console.
Local administration at the console implies physical access to the server.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_remote_session_encryption"/>
<ref disa="" nist="" srg="" stigid="WG230"/>
</Rule>

<Rule id="httpd_antivirus_scan_uploads" severity="medium" prodtype="rhel7">
<title>Scan All Uploaded Content for Malicious Software</title>
<description>
Install anti-virus software on the system and set it to automatically scan new
files that are introduced to the web server.
</description>
<ocil clause="it is not">
Remote web authors should not be able to upload files to the Document Root
directory structure without virus checking and checking for malicious or mobile
code.
</ocil>
<rationale>
Remote web authors should not be able to upload files to the Document Root
directory structure without virus checking and checking for malicious or mobile
code. A remote web user, whose agency has a Memorandum of Agreement (MOA) with
the hosting agency and has submitted a DoD form 2875 (System Authorization
Access Request (SAAR)) or an equivalent document, will be allowed to post files
to a temporary location on the server. All posted files to this temporary
location will be scanned for viruses and content checked for malicious or mobile
code. Only files free of viruses and malicious or mobile code will be posted to
the appropriate DocumentRoot directory.
</rationale>
<ident cce=""/>
<oval id="httpd_antivirus_scan_uploads"/>
<ref disa="" nist="" srg="" stigid="WG237"/>
</Rule>

<Group id="httpd_restrict_file_dir_access">
<title>Restrict File and Directory Access</title>
<description>
Minimize access to critical <tt>httpd</tt> files and directories.
</description>

<Rule id="dir_perms_var_log_httpd" severity="medium" prodtype="rhel7">
<title>Set Permissions on the <tt>/var/log/httpd/</tt> Directory</title>
<description>
Ensure that the permissions on the web server log directory is set to 700:
<pre>$ sudo chmod 700 /var/log/httpd/</pre>
This is its default setting.
</description>
<ocil clause="it is more permissive">
Run the following command to check the mode of the <tt>httpd</tt> log
directory:
<pre>$ ls -l /var/log/ | grep httpd</pre>
Log directory must be mode 0700 or less permissive.
</ocil>
<rationale>
A major tool in exploring the web site use, attempted use, unusual conditions,
and problems are the access and error logs. In the event of a security incident,
these logs can provide the SA and the web manager with valuable information. To
ensure the integrity of the log files and protect the SA and the web manager
from a conflict of interest related to the maintenance of these files, only the
members of the Auditors group will be granted permissions to move, copy, and
delete these files in the course of their duties related to the archiving of
these files.
</rationale>
<ident prodtype="rhel7" cce="80322-1" />
<oval id="dir_perms_var_log_httpd" />
<ref nist="CM-7" />
</Rule>

<Rule id="dir_perms_etc_httpd_conf" prodtype="rhel7">
<title>Set Permissions on the <tt>/etc/httpd/conf/</tt> Directory</title>
<description><fileperms-desc-macro file="/etc/http/conf" perms="0750"/></description>
<ocil><fileperms-check-macro file="/etc/http/conf" perms="-rwxr-x---"/></ocil>
<rationale>
Access to the web server's configuration files may allow an unauthorized user or attacker
to access information about the web server or alter the server's configuration files.
</rationale>
<oval id="dir_perms_etc_httpd_conf" />
<ident prodtype="rhel7" cce="80323-9" />
</Rule>

<Rule id="file_permissions_httpd_server_conf_files" prodtype="rhel7">
<title>Set Permissions on All Configuration Files Inside <tt>/etc/httpd/conf/</tt></title>
<description><fileperms-desc-macro file="/etc/http/conf/*" perms="0640"/></description>
<ocil><fileperms-check-macro file="/etc/http/conf/*" perms="-rw-r-----"/></ocil>
<rationale>
Access to the web server's configuration files may allow an unauthorized user or attacker
to access information about the web server or to alter the server's configuration files.
</rationale>
<oval id="file_permissions_httpd_server_conf_files" />
<ref nist="CM-7" />
<ident prodtype="rhel7" cce="80324-7" />
</Rule>

<Rule id="file_permissions_httpd_server_conf_d_files" prodtype="rhel7">
<title>Set Permissions on All Configuration Files Inside <tt>/etc/httpd/conf.d/</tt></title>
<description><fileperms-desc-macro file="/etc/http/conf.d/*" perms="0640"/></description>
<ocil><fileperms-check-macro file="/etc/http/conf.d/*" perms="-rw-r-----"/></ocil>
<rationale>
Access to the web server's configuration files may allow an unauthorized user or attacker
to access information about the web server or to alter the server's configuration files.
</rationale>
<oval id="file_permissions_httpd_server_conf_d_files" />
<ref nist="CM-7" />
<ident prodtype="rhel7" cce="80381-7" />
</Rule>

<Rule id="file_permissions_httpd_server_modules_files" prodtype="rhel7">
<title>Set Permissions on All Configuration Files Inside <tt>/etc/httpd/conf.modules.d/</tt></title>
<description><fileperms-desc-macro file="/etc/http/conf.modules.d/*" perms="0640"/></description>
<ocil><fileperms-check-macro file="/etc/http/conf.modules.d/*" perms="-rw-r-----"/></ocil>
<rationale>
Access to the web server's configuration files may allow an unauthorized user or attacker
to access information about the web server or to alter the server's configuration files.
</rationale>
<oval id="file_permissions_httpd_server_modules_files" />
<ref nist="CM-7" />
<ident prodtype="rhel7" cce="80382-5" />
</Rule>

<Rule id="http_configure_log_file_ownership" severity="medium" prodtype="rhel7">
<title>HTTPD Log Files Must Be Owned By Root</title>
<description>
All <tt>httpd</tt> logs must be owned by root user and group. By default,
the path for httpd logs is <tt>/var/log/httpd/</tt>
<fileowner-desc-macro file="/var/log/httpd" owner="root"/>
<fileowner-desc-macro file="/var/log/httpd/*" owner="root"/>
</description>
<ocil>
<fileowner-desc-macro file="/var/log/httpd" owner="root"/>
<fileowner-desc-macro file="/var/log/httpd/*" owner="root"/>
</ocil>
<rationale>
A major tool in exploring the web site use, attempted use, unusual conditions,
and problems are the access and error logs. In the event of a security incident,
these logs can provide the SA and the web administrator with valuable
information. Because of the information that is captured in the logs, it is
critical that only authorized individuals have access to the logs.
</rationale>
<ident cce=""/>
<oval id="http_configure_log_file_ownership"/>
<ref disa="" nist="" srg="" stigid="WG255"/>
</Rule>

</Group> <!-- <Group id="httpd_restrict_file_dir_access"> -->

<Rule id="httpd_configure_firewalld" severity="low" prodtype="rhel7">
<title>Configure <tt>firewalld</tt> to Allow Access to the Web Server</title>
<description>
By default, <tt>firewalld</tt>
blocks access to the ports used by the web server.
<firewalld-desc-macro allow="true" proto="tcp" service="http" />
<firewalld-desc-macro allow="true" proto="tcp" service="https" />
</description>
<ocil clause="it is not">
Review the web site to determine if HTTP and HTTPs are used in accordance with
well known ports (e.g., 80 and 443) or those ports and services as registered
and approved for use by the DoD PPSM.
<firewalld-desc-macro allow="true" proto="tcp" service="http" />
<firewalld-desc-macro allow="true" proto="tcp" service="https" />
</ocil>
<rationale>
Failure to comply with DoD ports, protocols, and services (PPS) requirements
can result in compromise of enclave boundary protections and/or functionality
of the AIS.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_firewalld"/>
<ref disa="" nist="" srg="" stigid="WG610"/>
</Rule>

<Group id="httpd_chroot">
<title>Run <tt>httpd</tt> in a <tt>chroot</tt> Jail if Practical</title>
<description>
Running <tt>httpd</tt> inside a <tt>chroot</tt> jail is designed to isolate the
web server process to a small section of the filesystem, limiting the damage if
it is compromised. Versions of Apache greater than 2.2.10 (such as the one
included with Red Hat Enterprise Linux 7) provide the <tt>ChrootDir</tt> directive. To run Apache
inside a chroot jail in <tt>/chroot/apache</tt>, add the following line to
<tt>/etc/httpd/conf/httpd.conf</tt>: <pre>ChrootDir /chroot/apache</pre> This
necessitates placing all files required by <tt>httpd</tt> inside
<tt>/chroot/apache</tt> , including <tt>httpd</tt>'s binaries, modules,
configuration files, and served web pages. The details of this configuration
are beyond the scope of this guide. This may also require additional SELinux
configuration.
</description>

</Group> <!-- <Group id="httpd_chroot"> -->

</Group> <!-- <Group id="httpd_configure_os_protect_web_server"> -->

<Group id="httpd_secure_content">
<title>Configure HTTPD-Served Web Content Securely</title>
<description>
Running <tt>httpd</tt> inside a <tt>chroot</tt> jail is designed to isolate the
web server process to a small section of the filesystem, limiting the damage if
it is compromised. Versions of Apache greater than 2.2.10 (such as the one
included with Red Hat Enterprise Linux 7) provide the <tt>ChrootDir</tt> directive. To run Apache
inside a chroot jail in <tt>/chroot/apache</tt>, add the following line to
<tt>/etc/httpd/conf/httpd.conf</tt>: <pre>ChrootDir /chroot/apache</pre> This
necessitates placing all files required by <tt>httpd</tt> inside
<tt>/chroot/apache</tt> , including <tt>httpd</tt>'s binaries, modules,
configuration files, and served web pages. The details of this configuration
are beyond the scope of this guide. This may also require additional SELinux
configuration.
</description>

<Value id="var_web_login_banner_text" type="string" operator="equals" interactive="0">
<title>Login Banner Verbiage</title>
<description>Enter an appropriate login banner for your organization. Please note that new lines must
be expressed by the '\n' character and special characters like parentheses and quotation marks must be escaped with '\'.</description>
<!-- <value selector="any_text">.+</value> -->
<value selector="usgcb_default">--[\s\n]+WARNING[\s\n]+--[\s\n]*This[\s\n]+system[\s\n]+is[\s\n]+for[\s\n]+the[\s\n]+use[\s\n]+of[\s\n]+authorized[\s\n]+users[\s\n]+only.[\s\n]+Individuals[\s\n]*using[\s\n]+this[\s\n]+computer[\s\n]+system[\s\n]+without[\s\n]+authority[\s\n]+or[\s\n]+in[\s\n]+excess[\s\n]+of[\s\n]+their[\s\n]*authority[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+having[\s\n]+all[\s\n]+their[\s\n]+activities[\s\n]+on[\s\n]+this[\s\n]+system[\s\n]*monitored[\s\n]+and[\s\n]+recorded[\s\n]+by[\s\n]+system[\s\n]+personnel.[\s\n]+Anyone[\s\n]+using[\s\n]+this[\s\n]*system[\s\n]+expressly[\s\n]+consents[\s\n]+to[\s\n]+such[\s\n]+monitoring[\s\n]+and[\s\n]+is[\s\n]+advised[\s\n]+that[\s\n]*if[\s\n]+such[\s\n]+monitoring[\s\n]+reveals[\s\n]+possible[\s\n]+evidence[\s\n]+of[\s\n]+criminal[\s\n]+activity[\s\n]*system[\s\n]+personal[\s\n]+may[\s\n]+provide[\s\n]+the[\s\n]+evidence[\s\n]+of[\s\n]+such[\s\n]+monitoring[\s\n]+to[\s\n]+law[\s\n]*enforcement[\s\n]+officials.</value>
<value selector="dod_default">You[\s\n]+are[\s\n]+accessing[\s\n]+a[\s\n]+U.S.[\s\n]+Government[\s\n]+\(USG\)[\s\n]+Information[\s\n]+System[\s\n]+\(IS\)[\s\n]+that[\s\n]+is[\s\n]+provided[\s\n]+for[\s\n]+USG-authorized[\s\n]+use[\s\n]+only.[\s\n]*By[\s\n]+using[\s\n]+this[\s\n]+IS[\s\n]+\(which[\s\n]+includes[\s\n]+any[\s\n]+device[\s\n]+attached[\s\n]+to[\s\n]+this[\s\n]+IS\),[\s\n]+you[\s\n]+consent[\s\n]+to[\s\n]+the[\s\n]+following[\s\n]+conditions\:[\s\n]*-[\s\n]*The[\s\n]+USG[\s\n]+routinely[\s\n]+intercepts[\s\n]+and[\s\n]+monitors[\s\n]+communications[\s\n]+on[\s\n]+this[\s\n]+IS[\s\n]+for[\s\n]+purposes[\s\n]+including,[\s\n]+but[\s\n]+not[\s\n]+limited[\s\n]+to,[\s\n]+penetration[\s\n]+testing,[\s\n]+COMSEC[\s\n]+monitoring,[\s\n]+network[\s\n]+operations[\s\n]+and[\s\n]+defense,[\s\n]+personnel[\s\n]+misconduct[\s\n]+\(PM\),[\s\n]+law[\s\n]+enforcement[\s\n]+\(LE\),[\s\n]+and[\s\n]+counterintelligence[\s\n]+\(CI\)[\s\n]+investigations.[\s\n]*-[\s\n]*At[\s\n]+any[\s\n]+time,[\s\n]+the[\s\n]+USG[\s\n]+may[\s\n]+inspect[\s\n]+and[\s\n]+seize[\s\n]+data[\s\n]+stored[\s\n]+on[\s\n]+this[\s\n]+IS.[\s\n]*-[\s\n]*Communications[\s\n]+using,[\s\n]+or[\s\n]+data[\s\n]+stored[\s\n]+on,[\s\n]+this[\s\n]+IS[\s\n]+are[\s\n]+not[\s\n]+private,[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+routine[\s\n]+monitoring,[\s\n]+interception,[\s\n]+and[\s\n]+search,[\s\n]+and[\s\n]+may[\s\n]+be[\s\n]+disclosed[\s\n]+or[\s\n]+used[\s\n]+for[\s\n]+any[\s\n]+USG-authorized[\s\n]+purpose.[\s\n]*-[\s\n]*This[\s\n]+IS[\s\n]+includes[\s\n]+security[\s\n]+measures[\s\n]+\(e.g.,[\s\n]+authentication[\s\n]+and[\s\n]+access[\s\n]+controls\)[\s\n]+to[\s\n]+protect[\s\n]+USG[\s\n]+interests--not[\s\n]+for[\s\n]+your[\s\n]+personal[\s\n]+benefit[\s\n]+or[\s\n]+privacy.[\s\n]*-[\s\n]*Notwithstanding[\s\n]+the[\s\n]+above,[\s\n]+using[\s\n]+this[\s\n]+IS[\s\n]+does[\s\n]+not[\s\n]+constitute[\s\n]+consent[\s\n]+to[\s\n]+PM,[\s\n]+LE[\s\n]+or[\s\n]+CI[\s\n]+investigative[\s\n]+searching[\s\n]+or[\s\n]+monitoring[\s\n]+of[\s\n]+the[\s\n]+content[\s\n]+of[\s\n]+privileged[\s\n]+communications,[\s\n]+or[\s\n]+work[\s\n]+product,[\s\n]+related[\s\n]+to[\s\n]+personal[\s\n]+representation[\s\n]+or[\s\n]+services[\s\n]+by[\s\n]+attorneys,[\s\n]+psychotherapists,[\s\n]+or[\s\n]+clergy,[\s\n]+and[\s\n]+their[\s\n]+assistants.[\s\n]+Such[\s\n]+communications[\s\n]+and[\s\n]+work[\s\n]+product[\s\n]+are[\s\n]+private[\s\n]+and[\s\n]+confidential.[\s\n]+See[\s\n]+User[\s\n]+Agreement[\s\n]+for[\s\n]+details.</value>
<value selector="dod_short">I\'ve[\s\n]+read[\s\n]+\&amp;[\s\n]+consent[\s\n]+to[\s\n]+terms[\s\n]+in[\s\n]+IS[\s\n]+user[\s\n]+agreem\'t.</value>
<value selector="dss_odaa_default">[\s\n]+Use[\s\n]+of[\s\n]+this[\s\n]+or[\s\n]+any[\s\n]+other[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system[\s\n]+constitutes[\s\n]+consent[\s\n]+to[\s\n]+monitoring[\s\n]+at[\s\n]+all[\s\n]+times.[\s\n]+This[\s\n]+is[\s\n]+a[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system.[\s\n]+All[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+systems[\s\n]+and[\s\n]+related[\s\n]+equipment[\s\n]+are[\s\n]+intended[\s\n]+for[\s\n]+the[\s\n]+communication,[\s\n]+transmission,[\s\n]+processing,[\s\n]+and[\s\n]+storage[\s\n]+of[\s\n]+official[\s\n]+U.S.[\s\n]+Government[\s\n]+or[\s\n]+other[\s\n]+authorized[\s\n]+information[\s\n]+only.[\s\n]+All[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+systems[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+monitoring[\s\n]+at[\s\n]+all[\s\n]+times[\s\n]+to[\s\n]+ensure[\s\n]+proper[\s\n]+functioning[\s\n]+of[\s\n]+equipment[\s\n]+and[\s\n]+systems[\s\n]+including[\s\n]+security[\s\n]+devices[\s\n]+and[\s\n]+systems,[\s\n]+to[\s\n]+prevent[\s\n]+unauthorized[\s\n]+use[\s\n]+and[\s\n]+violations[\s\n]+of[\s\n]+statutes[\s\n]+and[\s\n]+security[\s\n]+regulations,[\s\n]+to[\s\n]+deter[\s\n]+criminal[\s\n]+activity,[\s\n]+and[\s\n]+for[\s\n]+other[\s\n]+similar[\s\n]+purposes.[\s\n]+Any[\s\n]+user[\s\n]+of[\s\n]+a[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system[\s\n]+should[\s\n]+be[\s\n]+aware[\s\n]+that[\s\n]+any[\s\n]+information[\s\n]+placed[\s\n]+in[\s\n]+the[\s\n]+system[\s\n]+is[\s\n]+subject[\s\n]+to[\s\n]+monitoring[\s\n]+and[\s\n]+is[\s\n]+not[\s\n]+subject[\s\n]+to[\s\n]+any[\s\n]+expectation[\s\n]+of[\s\n]+privacy.[\s\n]+If[\s\n]+monitoring[\s\n]+of[\s\n]+this[\s\n]+or[\s\n]+any[\s\n]+other[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system[\s\n]+reveals[\s\n]+possible[\s\n]+evidence[\s\n]+of[\s\n]+violation[\s\n]+of[\s\n]+criminal[\s\n]+statutes,[\s\n]+this[\s\n]+evidence[\s\n]+and[\s\n]+any[\s\n]+other[\s\n]+related[\s\n]+information,[\s\n]+including[\s\n]+identification[\s\n]+information[\s\n]+about[\s\n]+the[\s\n]+user,[\s\n]+may[\s\n]+be[\s\n]+provided[\s\n]+to[\s\n]+law[\s\n]+enforcement[\s\n]+officials.[\s\n]+If[\s\n]+monitoring[\s\n]+of[\s\n]+this[\s\n]+or[\s\n]+any[\s\n]+other[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+systems[\s\n]+reveals[\s\n]+violations[\s\n]+of[\s\n]+security[\s\n]+regulations[\s\n]+or[\s\n]+unauthorized[\s\n]+use,[\s\n]+employees[\s\n]+who[\s\n]+violate[\s\n]+security[\s\n]+regulations[\s\n]+or[\s\n]+make[\s\n]+unauthorized[\s\n]+use[\s\n]+of[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+systems[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+appropriate[\s\n]+disciplinary[\s\n]+action.[\s\n]+Use[\s\n]+of[\s\n]+this[\s\n]+or[\s\n]+any[\s\n]+other[\s\n]+DoD[\s\n]+interest[\s\n]+computer[\s\n]+system[\s\n]+constitutes[\s\n]+consent[\s\n]+to[\s\n]+monitoring[\s\n]+at[\s\n]+all[\s\n]+times.</value>
<!-- First banner in 'dod_banners' must be the banner for desktop, laptop, and other devices which accomodate banners of 1300 characters -->
<value selector="dod_banners">^(You[\s\n]+are[\s\n]+accessing[\s\n]+a[\s\n]+U.S.[\s\n]+Government[\s\n]+\(USG\)[\s\n]+Information[\s\n]+System[\s\n]+\(IS\)[\s\n]+that[\s\n]+is[\s\n]+provided[\s\n]+for[\s\n]+USG-authorized[\s\n]+use[\s\n]+only.[\s\n]*By[\s\n]+using[\s\n]+this[\s\n]+IS[\s\n]+\(which[\s\n]+includes[\s\n]+any[\s\n]+device[\s\n]+attached[\s\n]+to[\s\n]+this[\s\n]+IS\),[\s\n]+you[\s\n]+consent[\s\n]+to[\s\n]+the[\s\n]+following[\s\n]+conditions\:[\s\n]*-[\s\n]*The[\s\n]+USG[\s\n]+routinely[\s\n]+intercepts[\s\n]+and[\s\n]+monitors[\s\n]+communications[\s\n]+on[\s\n]+this[\s\n]+IS[\s\n]+for[\s\n]+purposes[\s\n]+including,[\s\n]+but[\s\n]+not[\s\n]+limited[\s\n]+to,[\s\n]+penetration[\s\n]+testing,[\s\n]+COMSEC[\s\n]+monitoring,[\s\n]+network[\s\n]+operations[\s\n]+and[\s\n]+defense,[\s\n]+personnel[\s\n]+misconduct[\s\n]+\(PM\),[\s\n]+law[\s\n]+enforcement[\s\n]+\(LE\),[\s\n]+and[\s\n]+counterintelligence[\s\n]+\(CI\)[\s\n]+investigations.[\s\n]*-[\s\n]*At[\s\n]+any[\s\n]+time,[\s\n]+the[\s\n]+USG[\s\n]+may[\s\n]+inspect[\s\n]+and[\s\n]+seize[\s\n]+data[\s\n]+stored[\s\n]+on[\s\n]+this[\s\n]+IS.[\s\n]*-[\s\n]*Communications[\s\n]+using,[\s\n]+or[\s\n]+data[\s\n]+stored[\s\n]+on,[\s\n]+this[\s\n]+IS[\s\n]+are[\s\n]+not[\s\n]+private,[\s\n]+are[\s\n]+subject[\s\n]+to[\s\n]+routine[\s\n]+monitoring,[\s\n]+interception,[\s\n]+and[\s\n]+search,[\s\n]+and[\s\n]+may[\s\n]+be[\s\n]+disclosed[\s\n]+or[\s\n]+used[\s\n]+for[\s\n]+any[\s\n]+USG-authorized[\s\n]+purpose.[\s\n]*-[\s\n]*This[\s\n]+IS[\s\n]+includes[\s\n]+security[\s\n]+measures[\s\n]+\(e.g.,[\s\n]+authentication[\s\n]+and[\s\n]+access[\s\n]+controls\)[\s\n]+to[\s\n]+protect[\s\n]+USG[\s\n]+interests--not[\s\n]+for[\s\n]+your[\s\n]+personal[\s\n]+benefit[\s\n]+or[\s\n]+privacy.[\s\n]*-[\s\n]*Notwithstanding[\s\n]+the[\s\n]+above,[\s\n]+using[\s\n]+this[\s\n]+IS[\s\n]+does[\s\n]+not[\s\n]+constitute[\s\n]+consent[\s\n]+to[\s\n]+PM,[\s\n]+LE[\s\n]+or[\s\n]+CI[\s\n]+investigative[\s\n]+searching[\s\n]+or[\s\n]+monitoring[\s\n]+of[\s\n]+the[\s\n]+content[\s\n]+of[\s\n]+privileged[\s\n]+communications,[\s\n]+or[\s\n]+work[\s\n]+product,[\s\n]+related[\s\n]+to[\s\n]+personal[\s\n]+representation[\s\n]+or[\s\n]+services[\s\n]+by[\s\n]+attorneys,[\s\n]+psychotherapists,[\s\n]+or[\s\n]+clergy,[\s\n]+and[\s\n]+their[\s\n]+assistants.[\s\n]+Such[\s\n]+communications[\s\n]+and[\s\n]+work[\s\n]+product[\s\n]+are[\s\n]+private[\s\n]+and[\s\n]+confidential.[\s\n]+See[\s\n]+User[\s\n]+Agreement[\s\n]+for[\s\n]+details.|I\'ve[\s\n]+read[\s\n]+\&amp;[\s\n]+consent[\s\n]+to[\s\n]+terms[\s\n]+in[\s\n]+IS[\s\n]+user[\s\n]+agreem\'t.)$</value>
</Value>

<Rule id="httpd_configure_documentroot" severity="low" prodtype="rhel7">
<title>Each Web Content Directory Must Contain An index.html File</title>
<description>
Every <tt>DocumentRoot</tt> that is configured should have an
<tt>index.html</tt> file that exists. Add an <tt>index.html</tt> file to every
configured <tt>DocumentRoot</tt>.
</description>
<ocil clause="it is not">
To verify that each web content directory has an <tt>index.html</tt> file,
run the following command:
<pre>$ sudo find `grep -i documentroot /etc/httpd/conf/httpd.conf | awk -F'"' '{print $2}'` -name index.html</pre>
The output should return an <tt>index.html</tt> file for every
<tt>DocumentRoot</tt> that is set.
</ocil>
<rationale>
The goal is to completely control the web users experience in navigating any
portion of the web document root directories. Ensuring all web content
directories have at least the equivalent of an index.html file is a significant
factor to accomplish this end. Also, enumeration techniques, such as URL
parameter manipulation, rely upon being able to obtain information about the web
server's directory structure by locating directories with default pages. This
practice helps ensure that the anonymous web user will not obtain directory
browsing information or an error message that reveals the server type and
version.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_documentroot"/>
<ref disa="" nist="" srg="" stigid="WG170"/>
</Rule>

<Rule id="partition_for_web_content" severity="medium" prodtype="rhel7">
<title>Ensure Web Content Located on Separate partition</title>
<description>
The <tt>DocumentRoot</tt> directory is used for storing web content and data.
Ensure that the <tt>DocumentRoot</tt> directory exists on a separate logical
volume at installation time, or migrate it using LVM.
</description>
<ocil clause="it is not">
To verify that each web content directory exists on separate partitions,
run the following command:
<pre>$ grep `grep -i documentroot /etc/httpd/conf/httpd.conf | awk -F'"' '{print $2}'` /etc/fstab</pre>
Each of the corresponding <tt>DocumentRoot</tt> entries should have a
corresponding entry in <tt>/etc/fstab</tt>.
</ocil>
<rationale>
Application partitioning enables an additional security measure by securing
user traffic under one security context, while managing system and application
files under another. Web content is can be to an anonymous web user. For such
an account to have access to system files of any type is a major security risk
that is avoidable and desirable. Failure to partition the system files from the
web site documents increases risk of attack via directory traversal, or impede
web site availability due to drive space exhaustion.
</rationale>
<ident cce=""/>
<oval id="partition_for_web_content"/>
<ref disa="" nist="" srg="" stigid="WG205"/>
</Rule>

<Rule id="httpd_encrypt_file_uploads" severity="high" prodtype="rhel7">
<title>Encrypt All File Uploads</title>
<description>
Use only secure encrypted logons and connections for uploading files to the web
site.
</description>
<ocil clause="it is not">
Determine if there is a process for the uploading of files to the web site.
This process should include the requirement for the use of a secure encrypted
logon and secure encrypted connection. If the remote users are uploading files
without utilizing approved encryption methods, this is a finding.
</ocil>
<rationale>
Logging in to a web server via an unencrypted protocol or service, to upload
documents to the web site, is a risk if proper encryption is not utilized to
protect the data being transmitted. An encrypted protocol or service must be
used for remote access to web administration tasks.
</rationale>
<ident cce=""/>
<oval id="httpd_encrypt_file_uploads"/>
<ref disa="" nist="" srg="" stigid="WG235"/>
</Rule>

<Rule id="httpd_configure_banner_page" severity="low" prodtype="rhel7">
<title>Configure A Banner Page For Each Website</title>
<description>
Configure a login banner for each website when authentication is required for
user access.
</description>
<ocil clause="it is not display the required banner">
The document, DoDI 8500.01, establishes the policy on the use of DoD
information systems. It requires the use of a standard Notice and Consent Banner
and standard text to be included in user agreements. The banner should be set
to the following:
</ocil>
<rationale>
A consent banner will be in place to make prospective entrants aware that the
website they are about to enter is a DoD web site and their activity is subject
to monitoring. The document, DoDI 8500.01, establishes the policy on the use of
DoD information systems. It requires the use of a standard Notice and Consent
Banner and standard text to be included in user agreements. The requirement for
the banner is for websites with security and access controls. These are
restricted and not publicly accessible. If the website does not require
authentication/authorization for use, then the banner does not need to be
present. A manual check of the document root directory for a banner page file
(such as banner.html) or navigation to the website via a browser can be used to
confirm the information provided from interviewing the web staff.
</rationale>
<ident cce=""/>
<oval id="httpd_configure_banner_page" value="var_web_login_banner_text" />
<ref disa="" nist="" srg="" stigid="WG265"/>
</Rule>

<Rule id="httpd_remove_robots_file" severity="medium" prodtype="rhel7">
<title>The robots.txt Files Must Not Exist</title>
<description>
Remove any <tt>robots.txt</tt> files that may exist with any web content.
Other methods must be employed if there is information on the web site that
needs protection from search engines and public view. Inspect all instances of
<tt>DocumentRoot</tt> and <tt>Alias</tt> and remove any <tt>robots.txt</tt> file.
<pre>$ sudo rm -f path/to/robots.txt</pre>
</description>
<ocil clause="it is not">
Inspect all instances of <tt>DocumentRoot</tt> and <tt>Alias</tt>. No
<tt>robots.txt</tt> file should exist.
</ocil>
<rationale>
Search engines are constantly at work on the Internet. Search engines are
augmented by agents, often referred to as spiders or bots, which endeavor to
capture and catalog web-site content. In turn, these search engines make the
content they obtain and catalog available to any public web user.
<br/><br/>
To request
that a well behaved search engine not crawl and catalog a site, the web site may
contain a file called robots.txt. This file contains directories and files that
the web server SA desires not be crawled or cataloged, but this file can also be
used, by an attacker or poorly coded search engine, as a directory and file
index to a site. This information may be used to reduce an attacker's time
searching and traversing the web site to find files that might be relevant. If
information on the web site needs to be protected from search engines and public
view, other methods must be used.
</rationale>
<ident cce=""/>
<oval id="httpd_remove_robots_file"/>
<ref disa="" nist="" srg="" stigid="WG310"/>
</Rule>

<Rule id="httpd_disable_content_symlinks" severity="high" prodtype="rhel7">
<title>Disable Web Content Symbolic Links</title>
<description>
For each <tt>&lt;Directory&gt;</tt> instance, remove the following:
<pre>FollowSymLinks</pre>
If symbolic links are allowed, the following can be added for each
<tt>&lt;Directory&gt;</tt> instance:
<pre>Options SymLinksIfOwnerMatchDisable</pre>
</description>
<ocil clause="it is not">
Inspect each <tt>&lt;Directory&gt;</tt> instance and verify that either
<pre>FollowSymLinks</pre> does not exist, or
<pre>Options SymLinksIfOwnerMatchDisable</pre> is configured properly.
</ocil>
<rationale>
A symbolic link allows a file or a directory to be referenced using a symbolic
name raising a potential hazard if symbolic linkage is made to a sensitive area.
When web scripts are executed and symbolic links are allowed, the web user could
be allowed to access locations on the web server that are outside the scope of
the web document root or home directory.
</rationale>
<ident cce=""/>
<oval id="httpd_disable_content_symlinks"/>
<ref disa="" nist="" srg="" stigid="WG360"/>
</Rule>

<Rule id="httpd_limit_java_files" severity="low" prodtype="rhel7">
<title>Remove .java And .jpp Files</title>
<description>
<tt>.java</tt> and <tt>.jpp</tt> files should not exist and should be removed
from the web server.
</description>
<ocil clause="it is not">
To verify that no <tt>.java</tt> and <tt>.jpp</tt> files exist, run the
following command:
<pre>find / -name *.java -o -name *.jpp</pre>
The output should not return any <tt>.java</tt> or <tt>.jpp</tt> files
</ocil>
<rationale>
From the source code in a .java or a .jpp file, the Java compiler produces a
binary file with an extension of .class. The .java or .jpp file would,
therefore, reveal sensitive information regarding an application's logic and
permissions to resources on the server. By contrast, the .class file, because it
is intended to be machine independent, is referred to as bytecode. Bytecodes are
run by the Java Virtual Machine (JVM), or the Java Runtime Environment (JRE),
via a browser configured to permit Java code.
</rationale>
<ident cce=""/>
<oval id="httpd_limit_java_files"/>
<ref disa="" nist="" srg="" stigid="WG490"/>
</Rule>

</Group> <!-- <Group id="httpd_secure_content"> -->

</Group> <!-- <Group id="securing_httpd"> -->

</Group> <!-- <Group id="http"> -->
