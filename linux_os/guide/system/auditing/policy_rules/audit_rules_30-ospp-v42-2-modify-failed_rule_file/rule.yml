documentation_complete: true

prodtype: rhel8

title: 'Configure auditing with rules in 30-ospp-v42-2-modify-failed'

description: |-
    Configure audit to use rules located in the 30-ospp-v42-2-modify-failed.rules file.

    Audit defines groups of rules in <tt>/usr/share/audit/sample-rules</tt> to satisfy specific policies.

    To fulfill requirements for compliance with OSPP v4.2.1, the file 30-ospp-v42-2-modify-failed.rules is necessary.

    Copy the file located at <tt>/usr/share/audit/sample-rules/30-ospp-v42-2-modify-failed.rules</tt> to <tt>/etc/audit/rules.d</tt>:
    <pre>
    cp /usr/share/audit/sample-rules/30-ospp-v42-2-modify-failed.rules /etc/audit/rules.d/
    </pre>



rationale: |-
    The audit rules defined in <tt>/usr/share/audit/sample-rules</tt> are the recommended way to meet compliance with OSPP v4.2.1.

severity: medium

identifiers:
    cce@rhel8: 82376-5

references:
    ospp: FAU_GEN.1.1.c
    nist: AU-2(a)
    srg: SRG-OS-000004-GPOS-00004,SRG-OS-000240-GPOS-00090,SRG-OS-000241-GPOS-00091,SRG-OS-000303-GPOS-00120,SRG-OS-000476-GPOS-00221,SRG-OS-000327-GPOS-00127,SRG-OS-000064-GPOS-00033,SRG-OS-000365-GPOS-00152,SRG-OS-000458-GPOS-00203,SRG-OS-000461-GPOS-00205,SRG-OS-000462-GPOS-00206,SRG-OS-000463-GPOS-00207,SRG-OS-000465-GPOS-00209,SRG-OS-000466-GPOS-00210,SRG-OS-000467-GPOS-00211,SRG-OS-000468-GPOS-00212,SRG-OS-000470-GPOS-00214,SRG-OS-000471-GPOS-00215,SRG-OS-000471-GPOS-00216,SRG-OS-000472-GPOS-00217,SRG-OS-000474-GPOS-00219,SRG-OS-000475-GPOS-00220,SRG-OS-000477-GPOS-00222

ocil_clause: 'the file is not there or differs'

ocil: |-
    To verify that audit is correctly configured according to recommended rules, run the following commands:
    <pre>diff /usr/share/audit/sample-rules/30-ospp-v42-2-modify-failed.rules /etc/audit/rules.d/30-ospp-v42-2-modify-failed.rules</pre>

    If the system is configured properly, no lines should be returned.

template:
    name: audit_rules_rule_file
    vars:
        file_id: 30-ospp-v42-2-modify-failed
