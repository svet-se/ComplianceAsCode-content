documentation_complete: true

prodtype: sle12,sle15

title: 'Never Automatically Remove or Disable Emergency Administrator Accounts'

description: |-
    The shadow group allows system programs which require access the ability 
    to read the /etc/shadow file. No users should be assigned to the shadow group.

    Run the following commands and verify no results are returned:
    # grep ^shadow:[^:]*:[^:]*:[^:]+ /etc/group
    # awk -F: '($4 == "<shadow-gid>") { print }' /etc/passwd

    Remove all users from the shadow group, and change the primary group of any 
    users with shadow as their primary group.

rationale: |-
    Any users assigned to the shadow group would be granted read access to the 
    /etc/shadow file. If attackers can gain read access to the /etc/shadow file, 
    they can easily run a password cracking program against the hashed passwords 
    to break them. Other security information that is stored in the /etc/shadow 
    file (such as expiration) could also be useful to subvert additional user 
    accounts.

severity: medium

identifiers:
    cce@sle12: 
    cce@sle15: 

references:
    disa: CCI-001682
    nist@sle12: AC-2(2),AC-2(2).1(ii)
    srg: SRG-OS-000123-GPOS-00064
