documentation_complete: true

prodtype: rhel8

title: 'Configure session renegotiation for SSH client'

description: |-
    The <tt>RekeyLimit</tt> parameter specifies how often
    the session key is renegotiated, both in terms of
    amount of data that may be transmitted and the time
    elapsed. To decrease the default limits, put line
    <tt>RekeyLimit {{{ sub_var_value("var_ssh_client_rekey_limit_size") }}} {{{ sub_var_value("var_ssh_client_rekey_limit_time") }}}</tt> to file <tt>/etc/ssh/ssh_config.d/02-rekey-limit.conf</tt>.

rationale: |-
    By decreasing the limit based on the amount of data and enabling
    time-based limit, effects of potential attacks against
    encryption keys are limited.

severity: medium

identifiers:
    cce@rhel8: 82880-6

references:
    ospp: FCS_SSHS_EXT.1

ocil_clause: 'it is commented out or is not set'

ocil: |-
    To check if RekeyLimit is set correctly, run the
    following command:
    <pre>$ sudo grep RekeyLimit /etc/ssh/ssh_config.d/02-rekey-limit.conf</pre>
    If configured properly, output should be
    <pre>RekeyLimit {{{ sub_var_value("var_ssh_client_rekey_limit_size") }}} {{{ sub_var_value("var_ssh_client_rekey_limit_time") }}}</pre>
