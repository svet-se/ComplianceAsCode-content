documentation_complete: true

prodtype: fedora,rhcos4,ol7,ol8,rhel7,rhel8,rhv4

title: 'Install usbguard Package'

description: |-
    {{% if product != "rhcos4" %}}
    {{{ describe_package_install(package="usbguard") }}}
    {{% else %}}
    The <tt>usbguard</tt> package can be installed with the following manifest: 
    <pre>
    ---
    apiVersion: machineconfiguration.openshift.io/v1
    kind: MachineConfig
    metadata:
      labels:
        machineconfiguration.openshift.io/role: master
      name: 75-master-usbguard-install
    spec:
      config:
        ignition:
          version: 3.1.0
      extensions:
        - usbguard
    </pre>
    <p>
    This will install the <tt>usbguard</tt> package in all the
    nodes labeled with the "master" role.
    </p>
    <p>
    Note that this needs to be done for each <tt>MachineConfigPool</tt>
    </p>
    <p>
    For more information on how to configure nodes with the Machine Config
    Operator see
    {{{ weblink(link="https://docs.openshift.com/container-platform/4.6/post_installation_configuration/machine-configuration-tasks.html",
                text="the relevant documentation") }}}.
    </p>
    {{% endif %}}

rationale: |-
    <tt>usbguard</tt> is a software framework that helps to protect
    against rogue USB devices by implementing basic whitelisting/blacklisting
    capabilities based on USB device attributes.

severity: medium

identifiers:
    cce@rhel7: CCE-82960-6
    cce@rhel8: CCE-82959-8
    cce@rhcos4: CCE-82524-0

references:
    srg: SRG-OS-000378-GPOS-00163
    ism: "1418"

ocil_clause: 'the package is not installed'

ocil: '{{{ ocil_package(package="usbguard") }}}'

template:
    name: package_installed
    vars:
        pkgname: usbguard
